# PLAN D'ACTION PRESCRIPTIF : SEARCH-08 â€” IntÃ©gration complÃ¨te des champs Modash API dans l'interface de recherche

## User Story

En tant qu'utilisateur, je veux avoir accÃ¨s Ã  tous les champs de recherche disponibles dans l'API Modash (Instagram, YouTube, TikTok) organisÃ©s dans une interface intuitive par catÃ©gories, afin d'effectuer des recherches d'influenceurs ultra-prÃ©cises et exploiter toute la puissance de l'API.

---

## Contexte & dÃ©pendances

- Interface de recherche existante : `src/app/search/page.tsx`, `src/components/search/SearchSidebar.tsx` et filtres cards.
- Types actuels : `src/types/index.ts` (AdvancedSearchFilters, SearchUIState).
- Mock data : `src/lib/mockData.ts` (Ã  terme remplacÃ© par vrais appels Modash).
- Documentation API Modash complÃ¨te fournie par l'utilisateur.

---

## Objectifs

1. **Mapper tous les champs Modash** dans nos types TypeScript existants.
2. **Enrichir les catÃ©gories de filtres** : Creator, Audience, Content + nouvelle catÃ©gorie Platform.
3. **IntÃ©grer les dictionnaires Modash** (languages, locations, topics, hashtags, interests, brands, users).
4. **GÃ©rer les spÃ©cificitÃ©s par plateforme** (certains champs uniquement Instagram/YouTube/TikTok).
5. **PrÃ©server l'UX existante** tout en ajoutant les nouveaux champs de maniÃ¨re progressive.

---

## Analyse des champs Modash par catÃ©gorie

### ğŸ¯ **Creator Filters (influencer.\*)**

**Champs actuels Ã  enrichir :**

- âœ… `followers` (min/max) â€” dÃ©jÃ  prÃ©sent
- âœ… `engagementRate` â€” dÃ©jÃ  prÃ©sent
- âœ… `location` (array d'IDs) â€” dÃ©jÃ  prÃ©sent, Ã  connecter aux dictionnaires Modash
- âœ… `language` (code) â€” dÃ©jÃ  prÃ©sent, Ã  connecter au dictionnaire Modash
- âœ… `gender`, `age` (min/max) â€” dÃ©jÃ  prÃ©sents
- âœ… `isVerified` â€” dÃ©jÃ  prÃ©sent

**Nouveaux champs Creator Ã  ajouter :**

- ğŸ†• `lastposted` (jours depuis dernier post)
- ğŸ†• `relevance` (array hashtags/mentions pour pertinence)
- ğŸ†• `audienceRelevance` (mentions pour pertinence audience)
- ğŸ†• `followersGrowthRate` (interval, value, operator)
- ğŸ†• `bio` (recherche dans la bio)
- ğŸ†• `views` (min/max vues)
- ğŸ†• `hasContactDetails` (email, phone, etc.)
- ğŸ†• `keywords` (mots-clÃ©s)
- ğŸ†• `textTags` (hashtags/mentions structurÃ©es)
- ğŸ†• `engagements` (min/max)
- ğŸ†• **Instagram uniquement :** `hasYouTube`, `accountTypes`, `brands`, `interests`, `reelsPlays`, `hasSponsoredPosts`
- ğŸ†• **YouTube uniquement :** `viewsGrowthRate`, `isOfficialArtist`
- ğŸ†• **TikTok uniquement :** `shares`, `saves`, `likesGrowthRate`

### ğŸ‘¥ **Audience Filters (audience.\*)**

**Champs actuels Ã  enrichir :**

- âœ… `location` â€” Ã  enrichir avec systÃ¨me de weights
- âœ… `language` â€” Ã  enrichir avec systÃ¨me de weights
- âœ… `gender` â€” Ã  enrichir avec systÃ¨me de weights
- âœ… `age`/`ageRange` â€” Ã  enrichir avec systÃ¨me de weights

**Nouveaux champs Audience Ã  ajouter :**

- ğŸ†• **Instagram uniquement :** `interests` (avec weights), `credibility`

### ğŸ“± **Platform Filters (nouvelle catÃ©gorie)**

**Champs spÃ©cifiques par plateforme :**

- ğŸ†• `calculationMethod` ("median" | "average")
- ğŸ†• Gestion des champs diffÃ©rents par plateforme
- ğŸ†• `filterOperations` (opÃ©rateurs logiques entre filtres)

### ğŸ“„ **Content Filters (enrichissements)**

**Champs actuels Ã  enrichir :**

- âœ… Types de contenu par plateforme (posts, reels, videos, shorts)

**Nouveaux champs Content Ã  ajouter :**

- ğŸ†• Performance metrics par type de contenu
- ğŸ†• Posting frequency patterns

---

## Plan d'Action Prescriptif

### Ã‰tape 1 â€” Extension des types TypeScript

- [ ] **Enrichir `src/types/index.ts`** avec tous les nouveaux champs Modash :
  - [ ] `CreatorFilters` : ajouter tous les nouveaux champs influencer
  - [ ] `AudienceFilters` : ajouter systÃ¨me de weights + nouveaux champs
  - [ ] `PlatformFilters` : nouvelle interface pour champs spÃ©cifiques plateformes
  - [ ] `ModashDictionaries` : interfaces pour languages, locations, topics, etc.
  - [ ] Sous-types par plateforme : `InstagramFilters`, `YouTubeFilters`, `TikTokFilters`

### Ã‰tape 2 â€” Dictionnaires Modash (faÃ§ade data)

- [ ] **CrÃ©er `src/lib/modash/dictionaries.ts`** :
  - [ ] `getLanguages(platform, query?, limit?)`
  - [ ] `getLocations(platform, query?, limit?)`
  - [ ] `getTopics(platform, query?, limit?)`
  - [ ] `getHashtags(platform, query?, limit?)`
  - [ ] `getInterests(query?, limit?)` (Instagram seulement)
  - [ ] `getBrands(query?, limit?)` (Instagram seulement)
  - [ ] `getUsers(platform, query?, limit?)`
- [ ] **Mock data** pour dÃ©veloppement, avec structure identique aux rÃ©ponses Modash
- [ ] **Cache layer** pour Ã©viter les appels rÃ©pÃ©tÃ©s

### Ã‰tape 3 â€” Composant Platform Selection (refactor)

- [ ] **Enrichir `src/components/search/PlatformSearchCard.tsx`** :
  - [ ] Choix platform influence les champs disponibles dynamiquement
  - [ ] `calculationMethod` selector (median/average)
  - [ ] Message informatif sur les champs spÃ©cifiques Ã  chaque plateforme

### Ã‰tape 4 â€” Creator Filters Card (enrichissement majeur)

- [ ] **Refactor `src/components/search/CreatorFiltersCard.tsx`** :
  - [ ] **Section Growth & Activity** : `followersGrowthRate`, `lastposted`, `viewsGrowthRate`
  - [ ] **Section Content Performance** : `views`, `engagements`, `reelsPlays`
  - [ ] **Section Profile** : `bio` search, `hasContactDetails`, `isVerified`
  - [ ] **Section Relevance** : `relevance`, `audienceRelevance`, `keywords`, `textTags`
  - [ ] **Section Platform-specific** : champs conditionnels selon plateforme sÃ©lectionnÃ©e
  - [ ] **AutocomplÃ©tion** : intÃ©gration dictionnaires pour locations, languages, etc.

### Ã‰tape 5 â€” Audience Filters Card (systÃ¨me weights)

- [ ] **Refactor `src/components/search/AudienceFiltersCard.tsx`** :
  - [ ] **Weights sliders** pour chaque critÃ¨re audience (location, language, gender, age)
  - [ ] **Multiple selection** avec weights : locations multiples avec % importance
  - [ ] **Age ranges avancÃ©s** : plusieurs tranches d'Ã¢ge avec weights
  - [ ] **Instagram : interests & credibility** : sÃ©lection multiple + credibility slider

### Ã‰tape 6 â€” Content Filters Card (par plateforme)

- [ ] **Refactor `src/components/search/ContentFiltersCard.tsx`** :
  - [ ] **Filtres conditionnels** selon plateforme : reels (Instagram), shorts (YouTube), etc.
  - [ ] **Performance metrics** : vues, likes, comments par type de contenu
  - [ ] **Posting patterns** : frÃ©quence, jours de la semaine prÃ©fÃ©rÃ©s

### Ã‰tape 7 â€” Advanced Search Logic

- [ ] **CrÃ©er `src/lib/modash/searchBuilder.ts`** :
  - [ ] `buildModashQuery(filters, platform)` : transformation de nos filtres UI vers format Modash API
  - [ ] **Validation** des filtres selon la plateforme sÃ©lectionnÃ©e
  - [ ] **Gestion filterOperations** : AND/OR entre critÃ¨res
  - [ ] **Pagination & sorting** : intÃ©gration complÃ¨te

### Ã‰tape 8 â€” Components d'autocomplÃ©tion avancÃ©s

- [ ] **CrÃ©er `src/components/search/AutocompleteInput.tsx`** :
  - [ ] **Location picker** avec recherche gÃ©ographique
  - [ ] **Language selector** avec codes ISO
  - [ ] **Hashtags & Topics** avec suggestions en temps rÃ©el
  - [ ] **Users/Brands** avec preview cards
  - [ ] **Debouncing** pour Ã©viter trop d'appels API

### Ã‰tape 9 â€” Integration & Testing

- [ ] **Mise Ã  jour `src/app/search/page.tsx`** pour gÃ©rer les nouveaux filtres
- [ ] **Tests unitaires** des fonctions de transformation de filtres
- [ ] **Tests E2E** de l'interface complÃ¨te avec tous les nouveaux champs
- [ ] **Performance** : lazy loading des dictionnaires, virtualisation si nÃ©cessaire

### Ã‰tape 10 â€” Documentation & UX

- [ ] **Tooltips explicatifs** sur chaque nouveau champ complexe
- [ ] **Examples de recherche** contextuels selon la plateforme
- [ ] **Save/Load search presets** : permettre de sauvegarder des recherches complexes
- [ ] **Export advanced filters** : partager des configurations de recherche

---

## CritÃ¨res d'acceptation

- [ ] **Tous les champs Modash** sont disponibles dans l'interface de recherche, organisÃ©s logiquement.
- [ ] **Filtrage dynamique** : l'interface s'adapte Ã  la plateforme sÃ©lectionnÃ©e.
- [ ] **AutocomplÃ©tion** fonctionne sur tous les champs concernÃ©s (locations, languages, etc.).
- [ ] **SystÃ¨me de weights** permet de pondÃ©rer l'importance des critÃ¨res audience.
- [ ] **Recherche complexe** : combinaisons de filtres avec opÃ©rateurs logiques.
- [ ] **Performance** : interface fluide mÃªme avec tous les nouveaux champs.
- [ ] **Backward compatibility** : l'interface actuelle continue de fonctionner pendant la transition.
- [ ] **Build/Lint** : `npm run build` et `npm run lint` passent sans erreur.

---

## Risques & notes

- **ComplexitÃ© UI** : risque de surcharge cognitive avec trop de champs â†’ implÃ©mentation progressive, collapsibles.
- **Performance API** : dictionnaires peuvent Ãªtre volumineux â†’ cache intelligent et pagination.
- **Maintenance** : nouveaux champs Modash dans le futur â†’ architecture extensible.
- **UX** : utilisateurs novices vs experts â†’ mode "simple" et "avancÃ©".

---

## ğŸ¯ Champs Modash par plateforme (rÃ©fÃ©rence)

### ğŸ“± **Instagram Search Fields**

```typescript
influencer: {
  followers, engagementRate, location[], language, lastposted, relevance[],
  audienceRelevance[], gender, age, followersGrowthRate, bio, hasYouTube,
  hasContactDetails[], accountTypes[], brands[], interests[], keywords,
  textTags[], reelsPlays, isVerified, hasSponsoredPosts, engagements
}
audience: {
  location[], language, gender, age[], ageRange, interests[], credibility
}
```

### ğŸ¬ **YouTube Search Fields**

```typescript
influencer: {
  followers, engagementRate, location[], language, lastposted, relevance[],
  audienceRelevance[], gender, age, followersGrowthRate, bio, views,
  hasContactDetails[], keywords, isVerified, isOfficialArtist,
  viewsGrowthRate, engagements
}
audience: {
  location[], language, gender, age[], ageRange
}
```

### ğŸµ **TikTok Search Fields**

```typescript
influencer: {
  followers, engagementRate, location[], language, lastposted, relevance[],
  audienceRelevance[], gender, age, followersGrowthRate, bio, views,
  hasContactDetails[], textTags[], keywords, isVerified, likesGrowthRate,
  shares, saves, engagements
}
audience: {
  location[], language, gender, age[], ageRange
}
```

---

## ğŸš€ StratÃ©gie de dÃ©ploiement

1. **Phase 1** : Types + dictionnaires mock + Creator filters enrichis
2. **Phase 2** : Audience weights + Platform filters + autocomplÃ©tion de base
3. **Phase 3** : Content filters avancÃ©s + search builder + intÃ©gration API rÃ©elle
4. **Phase 4** : UX avancÃ©e + presets + optimisations performance

